{"version":3,"file":"generateJwt.js","names":["generateJwt","playbackId","signingKeyId","signingKeyPrivate","aud","payload","privateKey","Buffer","from","sign","JSON","parse","stringify","_","v","undefined","algorithm","keyid","audience","subject","noTimestamp","expiresIn"],"sources":["../../src/util/generateJwt.ts"],"sourcesContent":["import {sign} from 'jsonwebtoken'\n\nimport type {ThumbnailOptions} from './types'\n\nexport type Audience = 'g' | 's' | 't' | 'v'\n\nexport type Payload<T extends Audience> = T extends 'g'\n  ? never\n  : T extends 's'\n  ? never\n  : T extends 't'\n  ? ThumbnailOptions\n  : T extends 'v'\n  ? never\n  : never\n\nexport function generateJwt<T extends Audience>(\n  playbackId: string,\n  signingKeyId: string,\n  signingKeyPrivate: string,\n  aud: T,\n  payload?: Payload<T>\n): string {\n  const privateKey = Buffer.from(signingKeyPrivate, 'base64')\n  return sign(\n    payload ? JSON.parse(JSON.stringify(payload, (_, v) => v ?? undefined)) : {},\n    privateKey,\n    {\n      algorithm: 'RS256',\n      keyid: signingKeyId,\n      audience: aud,\n      subject: playbackId,\n      noTimestamp: true,\n      expiresIn: '12h',\n    }\n  )\n}\n"],"mappings":";;;;;;AAAA;AAgBO,SAASA,WAAW,CACzBC,UAAkB,EAClBC,YAAoB,EACpBC,iBAAyB,EACzBC,GAAM,EACNC,OAAoB,EACZ;EACR,IAAMC,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACL,iBAAiB,EAAE,QAAQ,CAAC;EAC3D,OAAO,IAAAM,kBAAI,EACTJ,OAAO,GAAGK,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACP,OAAO,EAAE,CAACQ,CAAC,EAAEC,CAAC,KAAKA,CAAC,aAADA,CAAC,cAADA,CAAC,GAAIC,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,EAC5ET,UAAU,EACV;IACEU,SAAS,EAAE,OAAO;IAClBC,KAAK,EAAEf,YAAY;IACnBgB,QAAQ,EAAEd,GAAG;IACbe,OAAO,EAAElB,UAAU;IACnBmB,WAAW,EAAE,IAAI;IACjBC,SAAS,EAAE;EACb,CAAC,CACF;AACH"}