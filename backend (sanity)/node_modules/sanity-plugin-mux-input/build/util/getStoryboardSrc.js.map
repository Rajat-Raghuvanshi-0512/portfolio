{"version":3,"file":"getStoryboardSrc.js","names":["getStoryboardSrc","asset","secrets","playbackId","getPlaybackId","searchParams","URLSearchParams","isSigned","token","generateJwt","signingKeyId","signingKeyPrivate","set"],"sources":["../../src/util/getStoryboardSrc.ts"],"sourcesContent":["import {generateJwt} from './generateJwt'\nimport {getPlaybackId} from './getPlaybackId'\nimport {isSigned} from './isSigned'\nimport type {MuxStoryboardUrl, Secrets, SignableSecrets, VideoAssetDocument} from './types'\n\ninterface StoryboardSrcOptions {\n  asset: VideoAssetDocument\n  secrets: Secrets | SignableSecrets\n}\n\nexport function getStoryboardSrc({asset, secrets}: StoryboardSrcOptions): MuxStoryboardUrl {\n  const playbackId = getPlaybackId(asset)\n  const searchParams = new URLSearchParams()\n\n  if (isSigned(asset, secrets as SignableSecrets)) {\n    const token = generateJwt(\n      playbackId,\n      // eslint-disable-next-line no-warning-comments\n      // @TODO figure out why isSigned doesn't manage to narrow down secrets to SignableSecrets\n      (secrets as SignableSecrets).signingKeyId,\n      (secrets as SignableSecrets).signingKeyPrivate,\n      's'\n    )\n    searchParams.set('token', token)\n  }\n\n  return `https://image.mux.com/${playbackId}/storyboard.vtt?${searchParams}`\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAQO,SAASA,gBAAgB,OAA2D;EAAA,IAAzDC,KAAK,QAALA,KAAK;IAAEC,OAAO,QAAPA,OAAO;EAC9C,IAAMC,UAAU,GAAG,IAAAC,4BAAa,EAACH,KAAK,CAAC;EACvC,IAAMI,YAAY,GAAG,IAAIC,eAAe,EAAE;EAE1C,IAAI,IAAAC,kBAAQ,EAACN,KAAK,EAAEC,OAAO,CAAoB,EAAE;IAC/C,IAAMM,KAAK,GAAG,IAAAC,wBAAW,EACvBN,UAAU;IACV;IACA;IACCD,OAAO,CAAqBQ,YAAY,EACxCR,OAAO,CAAqBS,iBAAiB,EAC9C,GAAG,CACJ;IACDN,YAAY,CAACO,GAAG,CAAC,OAAO,EAAEJ,KAAK,CAAC;EAClC;EAEA,uCAAgCL,UAAU,6BAAmBE,YAAY;AAC3E"}