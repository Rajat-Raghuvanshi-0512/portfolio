{"version":3,"file":"getPosterSrc.js","names":["getPosterSrc","asset","secrets","fit_mode","height","time","thumbTime","width","params","playbackId","getPlaybackId","searchParams","URLSearchParams","JSON","parse","stringify","_","v","undefined","isSigned","token","generateJwt","signingKeyId","signingKeyPrivate"],"sources":["../../src/util/getPosterSrc.ts"],"sourcesContent":["import {generateJwt} from './generateJwt'\nimport {getPlaybackId} from './getPlaybackId'\nimport {isSigned} from './isSigned'\nimport type {\n  MuxThumbnailUrl,\n  Secrets,\n  SignableSecrets,\n  ThumbnailOptions,\n  VideoAssetDocument,\n} from './types'\n\nexport interface PosterSrcOptions extends ThumbnailOptions {\n  asset: VideoAssetDocument\n  secrets: Secrets | SignableSecrets\n}\n\nexport function getPosterSrc({\n  asset,\n  secrets,\n  fit_mode,\n  height,\n  time = asset.thumbTime,\n  width,\n}: PosterSrcOptions): MuxThumbnailUrl {\n  const params = {fit_mode, height, time, width}\n  const playbackId = getPlaybackId(asset)\n\n  let searchParams = new URLSearchParams(\n    JSON.parse(JSON.stringify(params, (_, v) => v ?? undefined))\n  )\n  if (isSigned(asset, secrets as SignableSecrets)) {\n    const token = generateJwt(\n      playbackId,\n      // eslint-disable-next-line no-warning-comments\n      // @TODO figure out why isSigned doesn't manage to narrow down secrets to SignableSecrets\n      (secrets as SignableSecrets).signingKeyId,\n      (secrets as SignableSecrets).signingKeyPrivate,\n      't',\n      params\n    )\n    searchParams = new URLSearchParams({token})\n  }\n\n  return `https://image.mux.com/${playbackId}/thumbnail.png?${searchParams}`\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAcO,SAASA,YAAY,OAOU;EAAA,IANpCC,KAAK,QAALA,KAAK;IACLC,OAAO,QAAPA,OAAO;IACPC,QAAQ,QAARA,QAAQ;IACRC,MAAM,QAANA,MAAM;IAAA,iBACNC,IAAI;IAAJA,IAAI,0BAAGJ,KAAK,CAACK,SAAS;IACtBC,KAAK,QAALA,KAAK;EAEL,IAAMC,MAAM,GAAG;IAACL,QAAQ;IAAEC,MAAM;IAAEC,IAAI;IAAEE;EAAK,CAAC;EAC9C,IAAME,UAAU,GAAG,IAAAC,4BAAa,EAACT,KAAK,CAAC;EAEvC,IAAIU,YAAY,GAAG,IAAIC,eAAe,CACpCC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACP,MAAM,EAAE,CAACQ,CAAC,EAAEC,CAAC,KAAKA,CAAC,aAADA,CAAC,cAADA,CAAC,GAAIC,SAAS,CAAC,CAAC,CAC7D;EACD,IAAI,IAAAC,kBAAQ,EAAClB,KAAK,EAAEC,OAAO,CAAoB,EAAE;IAC/C,IAAMkB,KAAK,GAAG,IAAAC,wBAAW,EACvBZ,UAAU;IACV;IACA;IACCP,OAAO,CAAqBoB,YAAY,EACxCpB,OAAO,CAAqBqB,iBAAiB,EAC9C,GAAG,EACHf,MAAM,CACP;IACDG,YAAY,GAAG,IAAIC,eAAe,CAAC;MAACQ;IAAK,CAAC,CAAC;EAC7C;EAEA,uCAAgCX,UAAU,4BAAkBE,YAAY;AAC1E"}