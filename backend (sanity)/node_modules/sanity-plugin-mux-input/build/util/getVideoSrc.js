"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getVideoSrc = getVideoSrc;
var _generateJwt = require("./generateJwt");
var _getPlaybackId = require("./getPlaybackId");
var _isSigned = require("./isSigned");
function getVideoSrc(_ref) {
  var asset = _ref.asset,
    secrets = _ref.secrets;
  var playbackId = (0, _getPlaybackId.getPlaybackId)(asset);
  var searchParams = new URLSearchParams();
  if ((0, _isSigned.isSigned)(asset, secrets)) {
    var token = (0, _generateJwt.generateJwt)(playbackId,
    // eslint-disable-next-line no-warning-comments
    // @TODO figure out why isSigned doesn't manage to narrow down secrets to SignableSecrets
    secrets.signingKeyId, secrets.signingKeyPrivate, 'v');
    searchParams.set('token', token);
  }
  return "https://stream.mux.com/".concat(playbackId, ".m3u8?").concat(searchParams);
}
//# sourceMappingURL=getVideoSrc.js.map