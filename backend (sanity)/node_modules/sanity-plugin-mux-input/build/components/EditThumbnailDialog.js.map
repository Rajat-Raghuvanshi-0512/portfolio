{"version":3,"file":"EditThumbnailDialog.js","names":["EditThumbnailDialog","asset","getCurrentTime","onClose","videoReadyToPlay","secrets","dialogId","useId","nextTime","useMemo","assetWithNewThumbnail","thumbTime","useState","saving","setSaving","error","setError","handleSave","useCallback","client","patch","_id","set","commit","returnDocuments","catch","finally","width","getDevicePixelRatio","maxDpr"],"sources":["../../src/components/EditThumbnailDialog.tsx"],"sourcesContent":["import {useId} from '@reach/auto-id'\nimport {Button, Dialog, Stack, Text} from '@sanity/ui'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {getDevicePixelRatio} from 'use-device-pixel-ratio'\n\nimport client from '../clients/SanityClient'\nimport type {Secrets, VideoAssetDocument} from '../util/types'\nimport {VideoThumbnail} from './VideoSource.styles'\n\nexport interface Props {\n  asset: VideoAssetDocument\n  getCurrentTime: () => number\n  onClose: () => void\n  videoReadyToPlay: boolean\n  secrets: Secrets\n}\nexport default function EditThumbnailDialog({\n  asset,\n  getCurrentTime,\n  onClose,\n  videoReadyToPlay,\n  secrets,\n}: Props) {\n  const dialogId = `EditThumbnailDialog${useId()}`\n  const nextTime = useMemo(() => getCurrentTime(), [getCurrentTime])\n  const assetWithNewThumbnail = useMemo(() => ({...asset, thumbTime: nextTime}), [asset, nextTime])\n  const [saving, setSaving] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n  const handleSave = useCallback(() => {\n    setSaving(true)\n    client\n      .patch(asset._id!)\n      .set({thumbTime: nextTime})\n      .commit({returnDocuments: false})\n      .catch(setError)\n      .finally(() => setSaving(false))\n  }, [asset._id, nextTime])\n  const width = 300 * getDevicePixelRatio({maxDpr: 2})\n\n  if (error) {\n    // eslint-disable-next-line no-warning-comments\n    // @TODO handle errors more gracefully\n    throw error\n  }\n\n  return (\n    <Dialog\n      id={dialogId}\n      header=\"Edit thumbnail\"\n      onClose={onClose}\n      footer={\n        <Stack padding={3}>\n          <Button\n            key=\"thumbnail\"\n            mode=\"ghost\"\n            tone=\"primary\"\n            loading={saving}\n            onClick={handleSave}\n            disabled={videoReadyToPlay === false}\n            text=\"Set new thumbnail\"\n          />\n        </Stack>\n      }\n    >\n      <Stack space={3} padding={3}>\n        <Stack space={2}>\n          <Text size={1} weight=\"semibold\">\n            Current:\n          </Text>\n          <VideoThumbnail asset={asset} secrets={secrets} width={width} />\n        </Stack>\n        <Stack space={2}>\n          <Text size={1} weight=\"semibold\">\n            New:\n          </Text>\n          <VideoThumbnail asset={assetWithNewThumbnail} secrets={secrets} width={width} />\n        </Stack>\n      </Stack>\n    </Dialog>\n  )\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAEA;AAEA;AAAmD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASpC,SAASA,mBAAmB,OAMjC;EAAA,IALRC,KAAK,QAALA,KAAK;IACLC,cAAc,QAAdA,cAAc;IACdC,OAAO,QAAPA,OAAO;IACPC,gBAAgB,QAAhBA,gBAAgB;IAChBC,OAAO,QAAPA,OAAO;EAEP,IAAMC,QAAQ,gCAAyB,IAAAC,aAAK,GAAE,CAAE;EAChD,IAAMC,QAAQ,GAAG,IAAAC,cAAO,EAAC,MAAMP,cAAc,EAAE,EAAE,CAACA,cAAc,CAAC,CAAC;EAClE,IAAMQ,qBAAqB,GAAG,IAAAD,cAAO,EAAC,sCAAWR,KAAK;IAAEU,SAAS,EAAEH;EAAQ,EAAE,EAAE,CAACP,KAAK,EAAEO,QAAQ,CAAC,CAAC;EACjG,gBAA4B,IAAAI,eAAQ,EAAC,KAAK,CAAC;IAAA;IAApCC,MAAM;IAAEC,SAAS;EACxB,iBAA0B,IAAAF,eAAQ,EAAe,IAAI,CAAC;IAAA;IAA/CG,KAAK;IAAEC,QAAQ;EACtB,IAAMC,UAAU,GAAG,IAAAC,kBAAW,EAAC,MAAM;IACnCJ,SAAS,CAAC,IAAI,CAAC;IACfK,qBAAM,CACHC,KAAK,CAACnB,KAAK,CAACoB,GAAG,CAAE,CACjBC,GAAG,CAAC;MAACX,SAAS,EAAEH;IAAQ,CAAC,CAAC,CAC1Be,MAAM,CAAC;MAACC,eAAe,EAAE;IAAK,CAAC,CAAC,CAChCC,KAAK,CAACT,QAAQ,CAAC,CACfU,OAAO,CAAC,MAAMZ,SAAS,CAAC,KAAK,CAAC,CAAC;EACpC,CAAC,EAAE,CAACb,KAAK,CAACoB,GAAG,EAAEb,QAAQ,CAAC,CAAC;EACzB,IAAMmB,KAAK,GAAG,GAAG,GAAG,IAAAC,wCAAmB,EAAC;IAACC,MAAM,EAAE;EAAC,CAAC,CAAC;EAEpD,IAAId,KAAK,EAAE;IACT;IACA;IACA,MAAMA,KAAK;EACb;EAEA,oBACE,6BAAC,UAAM;IACL,EAAE,EAAET,QAAS;IACb,MAAM,EAAC,gBAAgB;IACvB,OAAO,EAAEH,OAAQ;IACjB,MAAM,eACJ,6BAAC,SAAK;MAAC,OAAO,EAAE;IAAE,gBAChB,6BAAC,UAAM;MACL,GAAG,EAAC,WAAW;MACf,IAAI,EAAC,OAAO;MACZ,IAAI,EAAC,SAAS;MACd,OAAO,EAAEU,MAAO;MAChB,OAAO,EAAEI,UAAW;MACpB,QAAQ,EAAEb,gBAAgB,KAAK,KAAM;MACrC,IAAI,EAAC;IAAmB,EACxB;EAEL,gBAED,6BAAC,SAAK;IAAC,KAAK,EAAE,CAAE;IAAC,OAAO,EAAE;EAAE,gBAC1B,6BAAC,SAAK;IAAC,KAAK,EAAE;EAAE,gBACd,6BAAC,QAAI;IAAC,IAAI,EAAE,CAAE;IAAC,MAAM,EAAC;EAAU,cAEzB,eACP,6BAAC,2BAAc;IAAC,KAAK,EAAEH,KAAM;IAAC,OAAO,EAAEI,OAAQ;IAAC,KAAK,EAAEsB;EAAM,EAAG,CAC1D,eACR,6BAAC,SAAK;IAAC,KAAK,EAAE;EAAE,gBACd,6BAAC,QAAI;IAAC,IAAI,EAAE,CAAE;IAAC,MAAM,EAAC;EAAU,UAEzB,eACP,6BAAC,2BAAc;IAAC,KAAK,EAAEjB,qBAAsB;IAAC,OAAO,EAAEL,OAAQ;IAAC,KAAK,EAAEsB;EAAM,EAAG,CAC1E,CACF,CACD;AAEb"}